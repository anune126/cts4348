<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu:300" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

    <title>CTS 4348</title>

    <link rel="stylesheet" href="css/container.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/user.css">
    <link rel="stylesheet" href="css/vm.css">
</head>

<body>
    <main>
        <div class="notifications">
            <span id="date"></span>
        </div>

        <section>
            <nav>
                <ul>
                    <li class="user active"><span class="user">GG</span><span class="ip" style="bottom: 15px; font-size: 14px;">Welcome ggome002</span></li>
                    <li class="vm" data-vm="101"><span class="name">Node 101</span><span class="ip">10.128.1.101</span></li>
                    <li class="vm" data-vm="102"><span class="name">Node 102</span><span class="ip">10.128.1.102</span></li>
                    <li class="vm" data-vm="103"><span class="name">Node 103</span><span class="ip">10.128.1.103</span></li>
                </ul>
            </nav>

            <div class="container">
                <div class="user ">
                    <h2>Notice:</h2>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus augue erat, sagittis a lorem at, blandit faucibus quam. Praesent ultricies quis lacus non aliquam.Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus augue
                        erat, sagittis a lorem at, blandit faucibus quam. Praesent ultricies quis lacus non aliquam.</p>
                    <br/>
                    <ul>
                        <li><span class="title">Assignment 1</span><span class="date">January 22, 2017</span><span class="action"><button data-icon="&#xE2C6;"></button></span></li>
                        <li><span class="title">Assignment 2</span><span class="date">February 05, 2017</span><span class="action"><button data-icon="&#xE2C6;"></button></span></li>
                        <li><span class="title">Assignment 3</span><span class="date">February 19, 2017</span><span class="action"><button data-icon="&#xE2C6;"></button></span></li>
                        <li><span class="title">Assignment 4</span><span class="date">March 05, 2017</span><span class="action"><button data-icon="&#xE2C6;"></button></span></li>
                        <li><span class="title">Assignment 5</span><span class="date">March 26, 2017</span><span class="action"><button data-icon="&#xE2C6;"></button></span></li>
                        <li><span class="title">Assignment 6</span><span class="date">April 9, 2017</span><span class="action"><button data-icon="&#xE2C6;"></button></span></li>
                        <li><span class="title">Assignment 7</span><span class="date">April 23, 2017</span><span class="action"><button data-icon="&#xE2C6;"></button></span></li>
                    </ul>
                </div>

                <div class="vm active" data-icon="&#xE30C;">
                    <h2>Node <span class="vm"></span></h2>
                    <div class="machine">
                        <ul>
                            <li data-list="CPU">1</li>
                            <li data-list="Memory">512 MB</li>
                            <li data-list="Hard disk">20 GB</li>
                            <li class="host" data-list="Host">CTS4348-A</li>
                            <li class="port" data-list="VNC Address">PORTS</li>
                            <li class="password" data-list="VNC Password">PASSWORD</li>
                        </ul>

                        <span>
                          <button onclick="progress()" data-icon="&#xE037;" data-name="start"></button>
                          <button onclick="progress()" data-icon="&#xE047;" data-name="stop"></button>
                          <button onclick="progress()" data-icon="&#xE042;" data-name="restart"></button>
                        </span>
                    </div>


                    <div class="snapshots">
                        <h3>snapshots</h3>
                        <p>Vivamus augue erat, sagittis a lorem at, blandit faucibus quam. Praesent ultricies quis lacus non aliquam.</p>
                        <ul>
                            <li><span class="title">Snapshot 1</span><span class="date">January 20, 2017</span><span class="action"><button data-icon="&#xE8B3;"></button><button data-icon="&#xE872;"></button></span>
                                <li><span class="title">Snapshot 2</span><span class="date">February 20, 2017</span><span class="action"><button data-icon="&#xE8B3;"></button><button data-icon="&#xE872;"></button></span></li>
                                <li><span class="title">Snapshot 3</span><span class="date">March 20, 2017</span><span class="action"><button data-icon="&#xE8B3;"></button><button data-icon="&#xE872;"></button></span></li>
                                <li><span class="title">Snapshot 4</span><span class="date">April 20, 2017</span><span class="action"><button class="delete">remove</button></span></li>

                                <li class="new"><span class="title" contenteditable="true">new snapshot</span><span class="date">now</span><span class="action" data-icon="&#xE2C6;"> <button class="add">add</button></span></li>
                                <li class="template"><span class="title" contenteditable="true">name</span><span class="date">now</span><span class="action" data-icon="&#xE2C6;"><button class="add">add</button></span></li>
                        </ul>
                    </div>
                </div>
            </div>
            </div>
        </section>
    </main>

    <script>
        // display date
        var d = new Date();
        document.getElementById("date").innerHTML = d.toDateString();

        // navigation
        $("main section nav ul li").click(
            function() {
                $("main section nav ul li").removeClass("active");
                $("div.container div").removeClass("active");
                $("div." + $(this).attr("class")).addClass("active");
                $(this).addClass("active");
                if ($(this).hasClass("vm")) {
                    $("div.container div.vm span.vm").html($(this).attr("data-vm"));
                }

                if (vms !== null) {
                    var thisVM = $(this).data("vm")
                    $("div.machine ul li.host").html(thisVM.host);
                    $("div.machine ul li.port").html(thisVM.vnc_port);
                    $("div.machine ul li.password").html(thisVM.vnc_password);
                }

            }
        )

        // progress bar
        function progress() {
            var elem = document.getElementById("progressBar");
            var width = 1;
            var id = setInterval(frame, 50);

            function frame() {
                if (width >= 100) {
                    clearInterval(id);
                } else {
                    width++;
                    elem.style.width = width / 3 + '%';
                    document.getElementById("bar").innerHTML = width * 1 + '%';
                }
            }
        }

        // delete snapshot
        $("button.delete").click(function() {

            $(this).closest("li").remove();
        })

        // add snapshot
        $("button.add").click(function() {

            if ($("div.snapshots ul li").length < 6) {

                $(this).closest("li").removeClass("new").find(".title").removeAttr("contenteditable");
                $(this).remove();
                $("div.snapshots ul").append($("div.snapshots ul li.template").clone(true).removeClass("template"));

                var time = new Date();
                $(this).closest("span.date").innerHTML = d.toDateString();
            } else {
                alert("Snapshot limit is 5")
            }
        })

        // clear new snapshot name
        $("div.snapshots ul li.new span.title").click(function() {
            $(this).closest("span.title").html("");
        });

        var vms = null
            //pull data from db
        function pull(username) {
            $.get("http://10.128.1.150/?username=" + username, function(data) {

                vms = JSON.parse(data)
                for (var i in vms) {
                    var li = $("li.vm")[i]
                    $(li).find("span.ip").html(vms[i].ip)
                    $(li).find("span.name").html(vms[i].name)
                    $(li).data("vm", vms[i])
                }
            });
        }
    </script>
</body>

</html>
